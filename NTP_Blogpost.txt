A recent post by Dan Drown in the official 
<a href="https://community.ntppool.org/t/recent-ntp-pool-traffic-increase/18">NTP community forum</a> reported that NTP IPv4 traffic has 
increased significantly since December 2013: 5x-20x 
normal traffic levels. Unfortunately, this unusual high load 
has a direct effect on NTP server performance.

Further investigations by Dan Brown and others researchers revealed 
that the traffic originated from mobile devices. More detailed analysis
that leveraged packet captures from those devices helped them to  
better illuminate the actual origin. This pointed out 
that Snapchat iOS version generate NTP traffic at a high rate.

Those findings motivated us to analyze whether any Android application
is also responsible for NTP activity and how they use this
critical network protocol. 
The <a href="https://play.google.com/store/apps/details?id=edu.berkeley.icsi.haystack&hl=en">Lumen 
Privacy Monitor</a> offers us a unique vantage point to capture and 
analyze accurate traffic traces generated by more than 3000 mobile apps
with real user-stimuli.  


According to our records, 72
	[NOTE: Update value and report on pre-installed services. 
		Remove those as "unknown" and also haystack]
applications use NTP. This covers popular 
application with more than 100M installs, such as whatsapp, games
like subway surfers, audio players like shazam, and tools such as
battery doctor and officesuit + pfd editor. We provide the full 
list of application and their number of installation, according to Google Play, 
at the end of this post.


If we classify the applications by their application category, using 
public information available on Google Play, we could identify 10 different 
application categories listed in the Table below.

	[NOTE: Add a table listing all the app categories. No analysis needed, just a list
		and the total number of apps for each category. 
		Group together pre-installed apps (which could also 
		be apps removed from the app store)]

Applications falling in the  "Tools", "Communication" and "Map & Navigation" categories 
register the most number of NTP request in Lumen database. 


WHAT NTP POOLS DO MOBILE ANDROID APPS USE?

Most applications use the NTP server infrastructure provided by ntp.gov. 
Some exceptions are applications using NIST's time servers, Qualcomm's
(time.izatcloud.net, possibly associated with A-GPS services), ...
	[NOTE: Investigate the other domains and list them here] 

We validated with active measurements from a machine
under our control in Spain that those domains host actual NTP servers. 
All machines replied to our NTP queries but s2m.time.edu.cn, which
is under the control of the "China education and research" authority.
We are unsure if this is an artifact implemented by the Great
Firewall of China. 


Although there is a specific NTP pool for android applications, 
<a href="ADD LINK">recommended by the NTP community</a>, only 18% of 
the application seem to communicate with it. However, if we compute
the volume of requests for each pool pool, Android's 
accounts for 75.5% of the total NTP requests in our records.
This fact recommends that just  limited number of android applications 
with high number of installation choose the right NTP pool. The app
categories using Android's NTP infrastructure are mostly tools 
and communication apps. 


NTP Domain	Query %	#APP
2.android.pool.ntp.org 	75.49 	8
pool.ntp.org 	12.47 	10
1.cn.pool.ntp.org 	2.16	17
north-america.pool.ntp.org	1.87 	3
asia.pool.ntp.org 	1.66 	3
0.asia.pool.ntp.org 	1.44 	10
time-a.nist.gov 	1.44 	2
ntp.nict.jp 	0.94 	2
time.izatcloud.net 	0.36 	1
2.asia.pool.ntp.org 	0.36 	5
europe.pool.ntp.org 	0.29 	2
0.us.pool.ntp.org 	0.14 	1
0.pool.ntp.org 	0.14 	2
3.time.crdcloud.com 	0.14 	1
ro.pool.ntp.org 	0.07 	1
1.time.crdcloud.com 	0.07 	1
us.pool.ntp.org 	0.07 	1
2.time.crdcloud.com 	0.07 	1
1.us.pool.ntp.org 	0.07 	1
2.us.pool.ntp.org 	0.07 	1
s2m.time.edu.cn 	0.07 	1



We extended our analysis by investigating the geographical distribution of
the NTP pool and their request. The following table lists domains which recived 
NTP query from android app, and the country-level location of its user
when available due to our privacy policies and our special efforts to avoid
user tracking. 

The results show that multiple NTP pools often receive queries from 
devices located out of their supposed 
region. This is probably caused by the fact that application developers
hardcode the NTP pools to be used by their apps. 
For instance asia.pool.ntp.org pool received considerable volume (82.62%)
from devices in Europe.
	[NOTE:	Are those apps implemented by Asian developers?
	Which apps are they?]
Likewise, "0.us.pool.ntp.org" presents a similar behavior:  
50% of its queries originated in Europe.
	[NOTE: Is there any study that has measured the effect
		of network latency on NTP accuracy? If so,
		contextualize the findings.]


			"Europe"	"North america"	"South america"	"Asia"	"Oceania"
2.android.pool.ntp.org	  45.88	  30.97	  18.46	  4.28	  0.42
pool.ntp.org	  36.0	  32.0	  8.0	  24.0	_
asia.pool.ntp.org	  82.61		_	  4.35	  13.04
time-a.nist.gov		_	  100.0		_	_	_
ntp.nict.jp	 69.23	  30.77	_	_	_
time.izatcloud.net   20.0   80.0	_	_	_
3.time.crdcloud.com	_   100.0	_	_	_
0.pool.ntp.org   50.0   50.0	_	_	_
0.us.pool.ntp.org   50.0   50.0	_	_	_
n1.netalyzr.icsi.berkeley.edu	_   50.0	_   50.0	_
north-america.pool.ntp.org	_  100.0	_	_	_
2.us.pool.ntp.org	_	  100.0		_	_	_
2.time.crdcloud.com	_	  100.0		_	_	_
ro.pool.ntp.org	  100.0		_	_	_	_
1.time.crdcloud.com	_	  100.0	_	_	_
us.pool.ntp.org	  100.0		_	_	_	_
1.us.pool.ntp.org	_	  100.0	_	_	_

FINAL REMARKS

This short study confirms that NTP traffic is commonly used by 
mobile applications, many of which are highly popular and
heavily used by mobile users all over the world. Unfortunately,
we are unable to answer to which extent those apps contribute to the
total increase of NTP queries reported by Dan Drown. We hoped, 
nevertheless, to shred some more light on the unknown usage
of NTP traffic by mobile apps and the role that application
developer may have in server loads and also in the final
accuracy of the NTP request. 

 there is a direct relation between
increasing the number of mobile devices and the number of NTP flows by
considering the Android application category which generate high volume of NTP
query. It tickles security concern. Also the current trend of selecting NTP pool
is not efficient and implies unnecessary delay to the communication. 


[NOTE: Extend table to add the app package, category (not available on GPlay
	for preinstalled), and all the pools that we
	successfully identified (avoid null or unknown). Sort by number of 
	installs.]

ID	Application Name	Number of installation
1	whatsapp messenger	1,000,000,000 - 5,000,000,000
2	iheartradio free music & radio	50,000,000 - 100,000,000
3	zomato - restaurant finder	5,000,000 - 10,000,000
4	android wear - smartwatch	5,000,000 - 10,000,000
5	live.me™– live video streaming	5,000,000 - 10,000,000
6	security - free	1,000,000 - 5,000,000
7	root master	100,000 - 500,000
8	coverage map	100,000 - 500,000
9	root call blocker	100,000 - 500,000
10	fast one-click root	10,000 - 50,000
11	timely alarm clock	5,000,000 - 10,000,000
12	email typeapp - best mail app!	1,000,000 - 5,000,000
13	webroot secureweb browser	100,000 - 500,000
14	blue mail - email mailbox	1,000,000 - 5,000,000
15	clockworkmod tether (no root)	1,000,000 - 5,000,000
16	faasos - order food online	1,000,000 - 5,000,000
17	shazam	100,000,000 - 500,000,000
18	netalyzr	50,000 - 100,000
19	myshake	100,000 - 500,000
20	hotels.com – hotel reservation	10,000,000 - 50,000,000
21	nest	1,000,000 - 5,000,000
22	officesuite + pdf editor	50,000,000 - 100,000,000
23	system monitor lite	100,000 - 500,000
24	officesuite pro + pdf (trial)	10,000,000 - 50,000,000
25	file commander - file manager	50,000,000 - 100,000,000
26	travel safety - free for kids	1,000,000 - 5,000,000
27	lyft - taxi app alternative	10,000,000 - 50,000,000
28	healthy eater - baby's diet	1,000,000 - 5,000,000
29	whatscall - free global calls	10,000,000 - 50,000,000
30	periscope - live video	10,000,000 - 50,000,000
31	baby panda care	10,000,000 - 50,000,000
32	onefootball live soccer scores	5,000,000 - 10,000,000
33	little panda's photo shop	500,000 - 1,000,000
34	officesuite pro + pdf	1,000,000 - 5,000,000
35	fish puzzles for kids - lite	100,000 - 500,000
36	t-mobile	10,000,000 - 50,000,000
38	lumen privacy monitor -no root	500 - 1,000
39	cooking fever	50,000,000 - 100,000,000
40	droid full system information	10,000 - 50,000
41	heavy machines - free for kids	1,000,000 - 5,000,000
42	parallel space－multi accounts	10,000,000 - 50,000,000
43	go90 - mobile tv network	10,000,000 - 50,000,000
44	uncc nextride	5,000 - 10,000
45	my shoes - baby panda	1,000,000 - 5,000,000
46	my baby gets organized	1,000,000 - 5,000,000
47	panda sharing adventure	500,000 - 1,000,000
48	toilet training - baby's potty	1,000,000 - 5,000,000
49	night and day - panda game	500,000 - 1,000,000
50	animal paradise	1,000,000 - 5,000,000
51	shazam encore	500,000 - 1,000,000
52	airbnb	10,000,000 - 50,000,000
53	t-mobile tv with mobile hd	10,000,000 - 50,000,000
54	little panda fireman	1,000,000 - 5,000,000
55	cartwheel by target	10,000,000 - 50,000,000
56	know your android network	10,000 - 50,000
57	plex for android	5,000,000 - 10,000,000
58	subway surfers	500,000,000 - 1,000,000,000
59	moon explorer: panda astronaut	1,000,000 - 5,000,000
60	intune company portal	500,000 - 1,000,000
61	battery doctor (power saver)	100,000,000 - 500,000,000
62	groove ip voip calls & text	1,000,000 - 5,000,000
63	makemytrip-flights hotels cabs	10,000,000 - 50,000,000
64	baby panda's birthday party	1,000,000 - 5,000,000
65	disney dream treats	1,000,000 - 5,000,000
66	bike race free motorcycle game	50,000,000 - 100,000,000
67	car safety - seats	1,000,000 - 5,000,000
68	drippler - your tech assistant	5,000,000 - 10,000,000
69	baby panda's supermarket	5,000,000 - 10,000,000
70	hola free vpn proxy	10,000,000 - 50,000,000
71	drippler - tech support & tips	5,000,000 - 10,000,000
72	4 pics 1 word	1,000,000 - 5,000,000


 
